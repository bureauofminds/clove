<Bridge node:id="rootNode" xmlns:node="com.bridge.module.NodeInstanceModule"
		xmlns:bind="com.bridge.module.bind.BindableModule"
		xmlns:Variable="com.bridge.module.VariableModule">  
    	

	
	<!-- needed to load any other assets in the media player --> 
	<String instance:id="host" value="{flashVars.host}" />      
                                                                            
	<!-- the playlist contains all video information in cue -->
	<XMLList instance:id="playList" /> 
	
	<!-- the currentVideo contains current video data -->
	<Object instance:id="currentVideo" name="No Video Selected" src="{flashVars.video}" />
	 
	<!-- contains all the cue functions -->
	<Object instance:id="cueHandlers" /> 
	
	<!-- binds the variable currentVideo so that any Object using it refreshes on change -->                  
	<bind:target instance="currentVideo" />
	
	<!-- KeyboardControl handles key commands -->
	<KeyboardControl instance:id="keyboardControl" target="{stage}" /> 
    
 	<Object instance:id="currentSkin" />

	<Container instance:id="behindFrame" percentWidth="100" percentHeight="100" visible="{false}" />
	 <VideoPlayer instance:id="videoPlayer" scaling="keepAspectRatio" load="{currentVideo.src}" verticalCenter="0"  horizontalCenter="0"/>
	
	<UIComponent instance:id="playerControler" style="backgroundColors:#000000;" percentWidth="100" percentHeight="100">
		
		
			
		
		<!-- the video constrictor is used incase the video player needs to be resized -->                         
		<UIComponent nstance:id="videoConstrictor"  style="backgroundColors:#000000;" percentWidth="100" percentHeight="100">    
		    <addRoute target="{videoConstrictor}" nodeName="videoConstrictor" />
		</UIComponent>
		
		
		<Container instance:id="coverFrame2" percentWidth="100" percentHeight="100" alpha="0" />
		
		
		<addRoute target="{coverFrame2}" nodeName="coverFrame" />
		
		  
		<!-- loads in the media player skin. Note that the skin CONTROLS the video player -->
		<!-- plugins ADD ONTO the video player --> 
		
		
		<create:function id="loadSkin">
			
			<variable:set name="skin" value="{loadSkin.params[0]}" />
			
			<call:function target="{rootNode.pause}" />
			
			<condition:check if="{skinFrame}">
				<run script="{skinFrame.parent.removeChild(skinFrame)}" />
			</condition:check>
			
			<variable:set name="paused" value="{videoPlayer.paused}" />
			<call:function target="{videoPlayer.pause}" />
			
			<Bridge>
				<UIComponent instance:id="skinFrame" percentWidth="100" percentHeight="100">
					<external:asset source="{skin}" type="script" />
				</UIComponent>
			</Bridge>
			
			<condition:check if="{!paused && currentVideo.src}">
				<call:function target="{videoPlayer.play}" />
			</condition:check>
			
			<call:function target="{rootNode.resume}" />
			
			
		</create:function>                                   
		
		
		<call:function target="{loadSkin}">
			<String value="{flashVars.skin}" />
		</call:function>
		
		<Container instance:id="coverAllFrame"  style="backgroundColors:#000000;" percentWidth="100" percentHeight="100" visible="{false}" />
		
		
    </UIComponent> 
	
		
	<!--speed test
		
		
		<Container percentWidth="100" alignment="horizontal">
		<for:loop start="0" stop="50">
			<Canvas percentWidth="100"/>
			<sleep time="200" />
		</for:loop>
	</Container>
	
-->
	<!-- splits up the plugins into an array -->
	<run script="{var plugins:Array = flashVars.plugins.split(',')}" />
	
	<!--load all the plugins -->
	<for:loop name="i" start="0" stop="{(plugins.length+-1)}">
		<external:asset source="{plugins[i]}" type="script" />
	</for:loop>
	
	
</Bridge>